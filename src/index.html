<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
    
    #app {
      position: relative;
    }
    .block {
      transition: all .5s;
      margin: 200px;
      width: 50px;
      height: 50px;
      background-color: blue;
      position: absolute;
    }

    </style>
</head>
<body>


    <div id="app">


      </div>

<script src="/socket.io/socket.io.js"></script>
<script>
  const app = document.getElementById("app");
  function createBlock(title) {
    const block = document.createElement("div");
    block.classList = "block";
    block.innerHTML = title;
    block.id = title;
    app.appendChild(block);
  }

  function newPlayerHandler(player) {
    console.log("new player added", player);
    createBlock(player);
  }

  function moveBlockHandler({player, move}) {
    const block = document.getElementById(player);
    console.log("moveBlockHandler", player, move);

    let movement = "translate(";

    switch (move) {
      case "up" : movement += 0 + "," + "-100" + "px"; break;
      case "down" : movement += 0 + "," + "100" + "px"; break;
      case "left" : movement += "-100" + "px," + 0 + "px"; break;
      case "right" : movement += "100" + "px," + 0 + "px"; break;
    }

    block.style.transform = movement + ")";
  }

  var socket = io();
  socket.emit('set data', {
      name : prompt("name", "user " + Math.round(Math.random() * 100))
    }
  );

  document.addEventListener("keydown", (e) => {
    e = e || window.event;

    if (e.keyCode == '38') {
      socket.emit('direction',"up");
    }
    else if (e.keyCode == '40') {
      socket.emit('direction',"down");
        // down arrow
    }
    else if (e.keyCode == '37') {
      socket.emit('direction',"left");
       // left arrow
    }
    else if (e.keyCode == '39') {
      socket.emit('direction',"right");
       // right arrow
    }

  });

  socket.on('movement', function(msg){
     console.log(msg)
    });

  socket.on("new player", newPlayerHandler);
  socket.on("move block", moveBlockHandler);

  
</script>
</body>
</html>